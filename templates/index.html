<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SmartBank - Future of Banking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .hidden {
        display: none !important;
      }

      /* Advanced Animations */
      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(50px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      @keyframes pulse-glow {
        0%,
        100% {
          box-shadow: 0 0 20px rgba(79, 70, 229, 0.4);
        }
        50% {
          box-shadow: 0 0 40px rgba(79, 70, 229, 0.8);
        }
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .animate-slide-up {
        animation: slideInUp 0.6s ease-out;
      }
      .animate-slide-right {
        animation: slideInRight 0.5s ease-out;
      }
      .animate-fade-scale {
        animation: fadeInScale 0.4s ease-out;
      }
      .animate-pulse-glow {
        animation: pulse-glow 2s infinite;
      }
      .animate-float {
        animation: float 3s ease-in-out infinite;
      }

      /* Glassmorphism & Modern Effects */
      .glass {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .glass-dark {
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      .gradient-mesh {
        background: linear-gradient(
          135deg,
          #667eea 0%,
          #764ba2 25%,
          #f093fb 50%,
          #f5576c 75%,
          #4facfe 100%
        );
        background-size: 400% 400%;
        animation: gradient-shift 8s ease infinite;
      }

      @keyframes gradient-shift {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      /* Advanced Components */
      .neo-btn {
        @apply relative overflow-hidden bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-2xl transform hover:-translate-y-1 hover:scale-105;
      }
      .neo-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }
      .neo-btn:hover::before {
        left: 100%;
      }

      .form-modern {
        @apply w-full px-6 py-4 bg-gray-50/80 backdrop-blur-sm border border-gray-200/50 rounded-2xl focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 transition-all duration-300 hover:bg-gray-100/80;
      }
      .form-modern:focus {
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      .sidebar-modern {
        @apply flex items-center px-6 py-4 mx-3 my-2 rounded-2xl cursor-pointer transition-all duration-300 hover:bg-gradient-to-r hover:from-indigo-500/20 hover:to-purple-500/20 hover:transform hover:translate-x-2;
      }
      .sidebar-modern.active {
        background: linear-gradient(135deg, #4f46e5, #7c3aed);
        color: white;
        transform: translateX(8px);
        box-shadow: 0 8px 25px rgba(79, 70, 229, 0.3);
      }

      .admin-sidebar-modern {
        @apply flex items-center px-6 py-4 mx-3 my-2 rounded-2xl cursor-pointer transition-all duration-300 hover:bg-gradient-to-r hover:from-red-500/20 hover:to-pink-500/20 hover:transform hover:translate-x-2;
      }
      .admin-sidebar-modern.active {
        background: linear-gradient(135deg, #dc2626, #e11d48);
        color: white;
        transform: translateX(8px);
        box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
      }

      .card-modern {
        @apply bg-white/80 backdrop-blur-xl rounded-3xl shadow-xl p-8 transition-all duration-500 hover:shadow-2xl hover:bg-white/90 border border-white/20;
      }
      .card-modern:hover {
        transform: translateY(-8px) scale(1.02);
      }

      .balance-card {
        @apply relative overflow-hidden;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      .balance-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: float 6s ease-in-out infinite;
      }

      /* Notification Styles */
      .notification {
        @apply fixed top-6 right-6 px-6 py-4 rounded-2xl shadow-lg z-50 transform transition-all duration-300;
      }
      .notification.success {
        @apply bg-green-500 text-white;
      }
      .notification.error {
        @apply bg-red-500 text-white;
      }
      .notification.info {
        @apply bg-blue-500 text-white;
      }

      /* Loading Animations */
      .spinner-modern {
        width: 60px;
        height: 60px;
        background: conic-gradient(
          from 0deg,
          #4f46e5,
          #7c3aed,
          #ec4899,
          #4f46e5
        );
        border-radius: 50%;
        animation: spin 1s linear infinite;
        position: relative;
      }
      .spinner-modern::before {
        content: "";
        position: absolute;
        top: 6px;
        left: 6px;
        right: 6px;
        bottom: 6px;
        background: white;
        border-radius: 50%;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Dark Mode Support */
      .dark .glass-card {
        background: rgba(31, 41, 55, 0.9);
      }
      .dark .form-modern {
        background: rgba(55, 65, 81, 0.8);
        border-color: rgba(75, 85, 99, 0.5);
        color: white;
      }
    </style>
  </head>
  <body class="h-full gradient-mesh">
    <div id="app" class="h-full">
      <!-- Homepage -->
      <div id="homepage-view" class="min-h-full">
        <nav class="glass-dark fixed w-full top-0 z-50">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
              <div class="flex items-center animate-slide-right">
                <div class="relative">
                  <i
                    class="fas fa-university text-3xl text-indigo-300 animate-pulse-glow"
                  ></i>
                  <div
                    class="absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-ping"
                  ></div>
                </div>
                <span class="ml-4 text-2xl font-bold text-white"
                  >SmartBank</span
                >
                <span
                  class="ml-2 text-xs bg-gradient-to-r from-indigo-400 to-purple-400 text-white px-2 py-1 rounded-full"
                  >AI Powered</span
                >
              </div>
              <div class="flex space-x-4">
                <button onclick="showModal('user-login-modal')" class="neo-btn">
                  <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
                <button
                  onclick="showModal('user-register-modal')"
                  class="glass px-6 py-3 rounded-2xl text-white font-semibold hover:bg-white/20 transition-all duration-300"
                >
                  <i class="fas fa-user-plus mr-2"></i>Register
                </button>
                <button
                  onclick="showModal('admin-login-modal')"
                  class="bg-red-600/80 backdrop-blur-sm px-6 py-3 rounded-2xl text-white font-semibold hover:bg-red-700/80 transition-all duration-300"
                >
                  <i class="fas fa-shield-alt mr-2"></i>Admin
                </button>
              </div>
            </div>
          </div>
        </nav>

        <div
          class="min-h-screen flex items-center justify-center relative overflow-hidden"
        >
          <!-- Floating Elements -->
          <div
            class="absolute top-1/4 left-1/4 w-32 h-32 bg-white/10 rounded-full animate-float"
            style="animation-delay: 0s"
          ></div>
          <div
            class="absolute top-1/3 right-1/4 w-24 h-24 bg-indigo-400/20 rounded-full animate-float"
            style="animation-delay: 1s"
          ></div>
          <div
            class="absolute bottom-1/4 left-1/3 w-40 h-40 bg-purple-400/10 rounded-full animate-float"
            style="animation-delay: 2s"
          ></div>

          <div class="text-center text-white px-4 relative z-10">
            <h1 class="text-6xl md:text-8xl font-black mb-6 animate-slide-up">
              The Future of
              <span
                class="bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-600 bg-clip-text text-transparent"
                >Banking</span
              >
            </h1>
            <p
              class="text-xl md:text-3xl text-white/90 mb-12 max-w-4xl mx-auto animate-slide-up"
              style="animation-delay: 0.2s"
            >
              Experience next-generation banking with AI-powered insights,
              quantum security, and seamless digital experiences.
            </p>
            <div
              class="flex flex-col sm:flex-row gap-6 justify-center animate-slide-up"
              style="animation-delay: 0.4s"
            >
              <button
                onclick="showModal('user-register-modal')"
                class="neo-btn text-xl px-12 py-6"
              >
                <i class="fas fa-rocket mr-3"></i>Get Started Now
              </button>
              <button
                onclick="scrollToFeatures()"
                class="glass px-12 py-6 rounded-2xl text-white font-bold text-xl hover:bg-white/20 transition-all duration-300"
              >
                <i class="fas fa-play mr-3"></i>Discover Features
              </button>
            </div>
          </div>
        </div>

        <!-- Features Section -->
        <div id="features-section" class="py-32 relative">
          <div class="max-w-7xl mx-auto px-4">
            <h2 class="text-5xl font-black text-center text-white mb-20">
              Revolutionary Features
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
              <div class="glass-card animate-fade-scale">
                <div class="text-indigo-600 text-5xl mb-6">
                  <i class="fas fa-brain"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">AI Financial Assistant</h3>
                <p class="text-gray-600">
                  Smart chatbot powered by advanced AI to help with all your
                  banking needs, 24/7.
                </p>
              </div>
              <div
                class="glass-card animate-fade-scale"
                style="animation-delay: 0.2s"
              >
                <div class="text-green-600 text-5xl mb-6">
                  <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">Quantum Security</h3>
                <p class="text-gray-600">
                  Military-grade encryption and biometric authentication for
                  ultimate security.
                </p>
              </div>
              <div
                class="glass-card animate-fade-scale"
                style="animation-delay: 0.4s"
              >
                <div class="text-purple-600 text-5xl mb-6">
                  <i class="fas fa-chart-line"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">Smart Analytics</h3>
                <p class="text-gray-600">
                  Real-time insights and predictive analytics for better
                  financial decisions.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- All Modals -->
      <div
        id="user-login-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4"
            >
              <i class="fas fa-user text-white text-2xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800">Welcome Back</h2>
            <p class="text-gray-600 mt-2">Sign in to your account</p>
          </div>
          <form id="user-login-form" class="space-y-6">
            <div class="relative">
              <i
                class="fas fa-user absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="user-username"
                class="form-modern pl-12"
                placeholder="Username"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="password"
                id="user-password"
                class="form-modern pl-12"
                placeholder="Password"
                required
              />
            </div>
            <button type="submit" class="neo-btn w-full text-lg">
              <i class="fas fa-sign-in-alt mr-2"></i>Sign In
            </button>
          </form>
          <p id="user-login-message" class="mt-6 text-center text-sm"></p>
          <div class="mt-8 text-center">
            <button
              onclick="closeModals()"
              class="text-gray-500 hover:text-gray-700 font-medium"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <div
        id="admin-login-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4"
            >
              <i class="fas fa-shield-alt text-white text-2xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800">Admin Access</h2>
            <p class="text-gray-600 mt-2">Secure administrative login</p>
          </div>
          <form id="admin-login-form" class="space-y-6">
            <div class="relative">
              <i
                class="fas fa-user-shield absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="admin-username"
                class="form-modern pl-12"
                placeholder="Admin Username"
                required
                value="admin"
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-key absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="password"
                id="admin-password"
                class="form-modern pl-12"
                placeholder="Admin Password"
                required
                value="admin123"
              />
            </div>
            <button
              type="submit"
              class="w-full bg-gradient-to-r from-red-600 to-pink-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-2xl transform hover:-translate-y-1"
            >
              <i class="fas fa-key mr-2"></i>Admin Access
            </button>
          </form>
          <p id="admin-login-message" class="mt-6 text-center text-sm"></p>
          <div class="mt-8 text-center">
            <button
              onclick="closeModals()"
              class="text-gray-500 hover:text-gray-700 font-medium"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <div
        id="user-register-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4"
            >
              <i class="fas fa-user-plus text-white text-2xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800">Join SmartBank</h2>
            <p class="text-gray-600 mt-2">Create your account in seconds</p>
          </div>
          <form id="register-form" class="space-y-6">
            <div class="relative">
              <i
                class="fas fa-user absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="register-username"
                class="form-modern pl-12"
                placeholder="Choose Username"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-envelope absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="email"
                id="register-email"
                class="form-modern pl-12"
                placeholder="Email Address"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="password"
                id="register-password"
                class="form-modern pl-12"
                placeholder="Create Password"
                required
              />
            </div>
            <button type="submit" class="neo-btn w-full text-lg">
              <i class="fas fa-rocket mr-2"></i>Create Account
            </button>
          </form>
          <p id="register-message" class="mt-6 text-center text-sm"></p>
          <div class="mt-8 text-center">
            <button
              onclick="closeModals()"
              class="text-gray-500 hover:text-gray-700 font-medium"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <!-- 2FA Modal -->
      <div
        id="tfa-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse-glow"
            >
              <i class="fas fa-mobile-alt text-white text-2xl"></i>
            </div>
            <h2 class="text-2xl font-bold text-gray-800">
              Two-Factor Authentication
            </h2>
            <p class="text-gray-600 mt-2">
              A verification code has been sent to your email.
            </p>
          </div>
          <div class="flex justify-center space-x-3 mb-8">
            <input
              type="text"
              maxlength="6"
              id="tfa-code"
              class="form-modern text-center tracking-[1em] text-2xl font-bold w-48"
              placeholder="000000"
            />
          </div>
          <button onclick="verify2FA()" class="neo-btn w-full">
            <i class="fas fa-check-circle mr-2"></i>Verify Code
          </button>
        </div>
      </div>

      <!-- User Dashboard -->
      <div id="user-dashboard" class="h-full hidden">
        <div class="flex h-full">
          <nav
            class="w-80 bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-gray-300 flex flex-col relative overflow-hidden"
          >
            <!-- Background Pattern -->
            <div class="absolute inset-0 opacity-10">
              <div
                class="absolute top-0 left-0 w-full h-full"
                style="
                  background-image: radial-gradient(
                      circle at 25% 25%,
                      #4f46e5 0%,
                      transparent 50%
                    ),
                    radial-gradient(
                      circle at 75% 75%,
                      #7c3aed 0%,
                      transparent 50%
                    );
                "
              ></div>
            </div>

            <div class="relative p-8 border-b border-gray-700/50">
              <div class="flex items-center">
                <div
                  class="w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center animate-pulse-glow"
                >
                  <i class="fas fa-university text-white text-xl"></i>
                </div>
                <div class="ml-4">
                  <h1 class="text-xl font-bold text-white">SmartBank</h1>
                  <p class="text-sm text-gray-400">User Portal</p>
                </div>
              </div>
              <div
                class="mt-6 p-4 bg-gradient-to-r from-indigo-500/20 to-purple-500/20 rounded-2xl"
              >
                <p class="text-xs text-gray-300">Welcome back,</p>
                <p id="sidebar-username" class="font-bold text-white text-lg">
                  User
                </p>
              </div>
            </div>

            <ul class="flex-grow p-6 space-y-2" id="user-sidebar-nav">
              <li>
                <a
                  href="#"
                  class="sidebar-modern active"
                  data-view="user-dashboard-content"
                >
                  <i class="fas fa-tachometer-alt w-6 text-center mr-4"></i>
                  <span class="font-medium">Dashboard</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="sidebar-modern"
                  data-view="user-transactions-content"
                >
                  <i class="fas fa-exchange-alt w-6 text-center mr-4"></i>
                  <span class="font-medium">Transactions</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="sidebar-modern"
                  data-view="user-billpay-content"
                >
                  <i
                    class="fas fa-file-invoice-dollar w-6 text-center mr-4"
                  ></i>
                  <span class="font-medium">Bill Payment</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="sidebar-modern"
                  data-view="user-profile-content"
                >
                  <i class="fas fa-user-circle w-6 text-center mr-4"></i>
                  <span class="font-medium">Profile</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="sidebar-modern"
                  data-view="user-settings-content"
                >
                  <i class="fas fa-cog w-6 text-center mr-4"></i>
                  <span class="font-medium">Settings</span>
                </a>
              </li>
            </ul>

            <div class="relative p-6 border-t border-gray-700/50">
              <button
                onclick="logout()"
                class="w-full bg-gradient-to-r from-red-600 to-pink-600 text-white px-6 py-4 rounded-2xl font-semibold transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1"
              >
                <i class="fas fa-sign-out-alt mr-2"></i>Sign Out
              </button>
            </div>
          </nav>

          <main class="flex-1 bg-gray-50 overflow-y-auto">
            <div class="p-8" id="user-main-content"></div>
          </main>
        </div>
      </div>

      <!-- Admin Dashboard -->
      <div id="admin-dashboard" class="h-full hidden">
        <div class="flex h-full">
          <nav
            class="w-80 bg-gradient-to-b from-red-900 via-red-800 to-red-900 text-gray-300 flex flex-col relative overflow-hidden"
          >
            <div class="absolute inset-0 opacity-10">
              <div
                class="absolute top-0 left-0 w-full h-full"
                style="
                  background-image: radial-gradient(
                      circle at 25% 25%,
                      #dc2626 0%,
                      transparent 50%
                    ),
                    radial-gradient(
                      circle at 75% 75%,
                      #e11d48 0%,
                      transparent 50%
                    );
                "
              ></div>
            </div>

            <div class="relative p-8 border-b border-red-700/50">
              <div class="flex items-center">
                <div
                  class="w-12 h-12 bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl flex items-center justify-center animate-pulse-glow"
                >
                  <i class="fas fa-shield-alt text-white text-xl"></i>
                </div>
                <div class="ml-4">
                  <h1 class="text-xl font-bold text-white">SmartBank</h1>
                  <p class="text-sm text-gray-400">Admin Control</p>
                </div>
              </div>
            </div>

            <ul class="flex-grow p-6 space-y-2" id="admin-sidebar-nav">
              <li>
                <a
                  href="#"
                  class="admin-sidebar-modern active"
                  data-view="admin-dashboard-content"
                >
                  <i class="fas fa-tachometer-alt w-6 text-center mr-4"></i>
                  <span class="font-medium">Overview</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="admin-sidebar-modern"
                  data-view="admin-users-content"
                >
                  <i class="fas fa-users w-6 text-center mr-4"></i>
                  <span class="font-medium">Users</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="admin-sidebar-modern"
                  data-view="admin-transactions-content"
                >
                  <i class="fas fa-exchange-alt w-6 text-center mr-4"></i>
                  <span class="font-medium">Transactions</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="admin-sidebar-modern"
                  data-view="admin-reports-content"
                >
                  <i class="fas fa-chart-line w-6 text-center mr-4"></i>
                  <span class="font-medium">Reports</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="admin-sidebar-modern"
                  data-view="admin-security-content"
                >
                  <i class="fas fa-lock w-6 text-center mr-4"></i>
                  <span class="font-medium">Security</span>
                </a>
              </li>
            </ul>

            <div class="relative p-6 border-t border-red-700/50">
              <button
                onclick="logout()"
                class="w-full bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-4 rounded-2xl font-semibold transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1"
              >
                <i class="fas fa-sign-out-alt mr-2"></i>Sign Out
              </button>
            </div>
          </nav>

          <main class="flex-1 bg-gray-50 overflow-y-auto">
            <div class="p-8" id="admin-main-content"></div>
          </main>
        </div>
      </div>

      <!-- Enhanced AI Chatbot -->
      <div id="chatbot-container" class="fixed bottom-8 right-8 z-40 hidden">
        <button
          id="chatbot-toggle"
          class="w-20 h-20 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 flex items-center justify-center transform hover:scale-110 animate-pulse-glow"
        >
          <i class="fas fa-robot text-3xl"></i>
          <div
            class="absolute -top-2 -right-2 w-6 h-6 bg-green-400 rounded-full flex items-center justify-center animate-ping"
          >
            <i class="fas fa-circle text-xs"></i>
          </div>
        </button>
        <div
          id="chatbot-window"
          class="hidden absolute bottom-24 right-0 w-96 h-[32rem] glass-card flex flex-col animate-fade-scale"
        >
          <div
            class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6 rounded-t-3xl flex items-center justify-between"
          >
            <div class="flex items-center">
              <div
                class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3"
              >
                <i class="fas fa-robot"></i>
              </div>
              <div>
                <span class="font-bold text-lg">SmartBot</span>
                <div class="flex items-center text-sm text-indigo-100">
                  <div
                    class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-ping"
                  ></div>
                  Online
                </div>
              </div>
            </div>
            <button
              id="chatbot-close"
              class="text-white/80 hover:text-white transition-colors"
            >
              <i class="fas fa-times text-lg"></i>
            </button>
          </div>
          <div
            id="chat-messages"
            class="p-6 flex-grow overflow-y-auto bg-gradient-to-b from-gray-50 to-white"
          >
            <div class="chat-bubble chat-bot mb-4">
              <div class="flex items-start">
                <div
                  class="w-8 h-8 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mr-3 flex-shrink-0"
                >
                  <i class="fas fa-robot text-white text-sm"></i>
                </div>
                <div>
                  <p class="font-medium text-gray-800 mb-1">SmartBot</p>
                  <p class="text-gray-600">
                    Hello! I'm your AI banking assistant. How can I help you
                    today?
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="p-6 border-t bg-white rounded-b-3xl">
            <div class="flex space-x-3">
              <input
                type="text"
                id="chat-input"
                class="flex-1 form-modern py-3"
                placeholder="Ask me anything..."
              />
              <button id="send-message" class="neo-btn px-6 py-3">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
            <div class="flex space-x-2 mt-3">
              <button
                onclick="quickChat('Check my balance')"
                class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-full transition-colors"
              >
                Balance
              </button>
              <button
                onclick="quickChat('Show recent transactions')"
                class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-full transition-colors"
              >
                Transactions
              </button>
              <button
                onclick="quickChat('Help with bill payment')"
                class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-full transition-colors"
              >
                Bills
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading Overlay -->
      <div
        id="loading-overlay"
        class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="text-center">
          <div class="spinner-modern mx-auto mb-4"></div>
          <p class="text-white text-lg font-medium">Processing...</p>
        </div>
      </div>

      <!-- Notification Container -->
      <div
        id="notification-container"
        class="fixed top-6 right-6 z-50 space-y-4"
      ></div>

      <!-- Templates -->
      <template id="user-dashboard-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-2 animate-slide-up">
            Welcome back,
            <span
              id="dashboard-username"
              class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent"
              >User</span
            >!
          </h1>
          <p class="text-gray-600 text-lg">
            Here's your financial overview for today
          </p>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
          <!-- Main Content -->
          <div class="xl:col-span-2 space-y-8">
            <!-- Balance Card -->
            <div
              class="card-modern balance-card text-white relative overflow-hidden"
            >
              <div class="relative z-10">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <p class="text-white/80 text-sm font-medium">
                      Total Balance
                    </p>
                    <p id="account-balance" class="text-5xl font-black">
                      $0.00
                    </p>
                  </div>
                  <div
                    class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center"
                  >
                    <i class="fas fa-wallet text-2xl"></i>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-white/80 text-sm">Account Number</p>
                    <p id="account-number" class="font-bold text-lg">
                      ••••••••••
                    </p>
                  </div>
                  <div class="flex space-x-2">
                    <div
                      class="w-2 h-2 bg-white rounded-full animate-ping"
                    ></div>
                    <div class="w-2 h-2 bg-white/60 rounded-full"></div>
                    <div class="w-2 h-2 bg-white/30 rounded-full"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Actions -->
            <div class="card-modern">
              <h3
                class="text-2xl font-bold text-gray-800 mb-6 flex items-center"
              >
                <i class="fas fa-bolt text-yellow-500 mr-3"></i>
                Quick Transfer
              </h3>
              <form
                id="transaction-form"
                class="grid grid-cols-1 lg:grid-cols-4 gap-4"
              >
                <div class="relative">
                  <i
                    class="fas fa-university absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                  ></i>
                  <input
                    type="text"
                    id="to-account"
                    class="form-modern pl-12"
                    placeholder="Recipient Account"
                    required
                  />
                </div>
                <div class="relative">
                  <i
                    class="fas fa-dollar-sign absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                  ></i>
                  <input
                    type="number"
                    id="amount"
                    class="form-modern pl-12"
                    placeholder="Amount"
                    step="0.01"
                    min="0.01"
                    required
                  />
                </div>
                <div class="relative">
                  <i
                    class="fas fa-comment absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                  ></i>
                  <input
                    type="text"
                    id="description"
                    class="form-modern pl-12"
                    placeholder="Description (optional)"
                  />
                </div>
                <button type="submit" class="neo-btn h-14">
                  <i class="fas fa-paper-plane mr-2"></i>Send
                </button>
              </form>
              <p id="transaction-message" class="text-sm mt-4"></p>
            </div>

            <!-- Recent Activity -->
            <div class="card-modern">
              <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800 flex items-center">
                  <i class="fas fa-history text-blue-500 mr-3"></i>
                  Recent Activity
                </h3>
                <button
                  onclick="loadViewContent('user-transactions-content', 'user-main-content')"
                  class="text-indigo-600 hover:text-indigo-700 font-medium"
                >
                  View All <i class="fas fa-arrow-right ml-1"></i>
                </button>
              </div>
              <div id="recent-transactions" class="space-y-4">
                <!-- Will be populated -->
              </div>
            </div>
          </div>

          <!-- Sidebar -->
          <div class="space-y-8">
            <!-- Spending Insights -->
            <div class="card-modern">
              <h3
                class="text-xl font-bold text-gray-800 mb-6 flex items-center"
              >
                <i class="fas fa-chart-pie text-green-500 mr-3"></i>
                Spending Insights
              </h3>
              <div class="relative">
                <canvas id="spending-chart" class="max-h-64"></canvas>
                <p
                  id="spending-chart-fallback"
                  class="text-center text-gray-500 hidden py-8"
                >
                  <i
                    class="fas fa-chart-pie text-4xl text-gray-300 mb-4 block"
                  ></i>
                  No spending data yet
                </p>
              </div>
            </div>

            <!-- Quick Stats -->
            <div class="card-modern">
              <h3 class="text-xl font-bold text-gray-800 mb-6">Quick Stats</h3>
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">This Month</span>
                  <span class="font-bold text-green-600">+$2,450</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Transactions</span>
                  <span class="font-bold text-blue-600" id="transaction-count"
                    >0</span
                  >
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Avg. Transaction</span>
                  <span class="font-bold text-purple-600" id="avg-transaction"
                    >$0</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </template>

      <template id="user-transactions-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Transaction History
          </h1>
          <p class="text-gray-600 text-lg">
            Track all your financial activities
          </p>
        </div>

        <!-- Filters -->
        <div class="card-modern mb-8">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <select id="filter-type" class="form-modern">
              <option value="">All Types</option>
              <option value="Transfer">Transfers</option>
              <option value="Utilities">Utilities</option>
              <option value="Internet">Internet</option>
              <option value="Insurance">Insurance</option>
            </select>
            <input type="date" id="filter-from" class="form-modern" />
            <input type="date" id="filter-to" class="form-modern" />
            <button onclick="applyFilters()" class="neo-btn">
              <i class="fas fa-filter mr-2"></i>Filter
            </button>
          </div>
        </div>

        <div class="card-modern">
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Transaction
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Type
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Amount
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Date
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Status
                  </th>
                </tr>
              </thead>
              <tbody id="transaction-history" class="divide-y divide-gray-200">
                <!-- Transactions will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </template>

      <template id="user-billpay-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Bill Payment
          </h1>
          <p class="text-gray-600 text-lg">
            Pay your bills quickly and securely
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
              <i class="fas fa-file-invoice-dollar text-green-500 mr-3"></i>
              Pay Bill
            </h3>
            <form id="billpay-form" class="space-y-6">
              <div class="relative">
                <i
                  class="fas fa-building absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <select id="biller-select" class="form-modern pl-12" required>
                  <option value="" disabled selected>Choose a biller...</option>
                </select>
              </div>
              <div class="relative">
                <i
                  class="fas fa-dollar-sign absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <input
                  type="number"
                  id="bill-amount"
                  class="form-modern pl-12"
                  placeholder="Amount to pay"
                  step="0.01"
                  min="0.01"
                  required
                />
              </div>
              <div class="relative">
                <i
                  class="fas fa-calendar absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <input type="date" id="bill-date" class="form-modern pl-12" />
              </div>
              <button type="submit" class="neo-btn w-full text-lg">
                <i class="fas fa-credit-card mr-2"></i>Pay Now
              </button>
            </form>
            <p id="billpay-message" class="text-sm mt-4 text-center"></p>
          </div>

          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Saved Billers</h3>
            <div id="saved-billers" class="space-y-4">
              <!-- Will be populated with saved billers -->
            </div>
          </div>
        </div>
      </template>

      <template id="user-profile-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Profile Settings
          </h1>
          <p class="text-gray-600 text-lg">Manage your account information</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
              Personal Information
            </h3>
            <form id="profile-form" class="space-y-6">
              <div class="relative">
                <i
                  class="fas fa-user absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <input
                  type="text"
                  id="profile-username"
                  class="form-modern pl-12"
                  placeholder="Username"
                  readonly
                />
              </div>
              <div class="relative">
                <i
                  class="fas fa-envelope absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <input
                  type="email"
                  id="profile-email"
                  class="form-modern pl-12"
                  placeholder="Email"
                />
              </div>
              <div class="relative">
                <i
                  class="fas fa-phone absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
                ></i>
                <input
                  type="tel"
                  id="profile-phone"
                  class="form-modern pl-12"
                  placeholder="Phone Number"
                />
              </div>
              <button type="submit" class="neo-btn">
                <i class="fas fa-save mr-2"></i>Save Changes
              </button>
            </form>
          </div>

          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
              Security Settings
            </h3>
            <div class="space-y-6">
              <div
                class="flex items-center justify-between p-4 bg-gray-50 rounded-xl"
              >
                <div>
                  <p class="font-semibold text-gray-800">
                    Two-Factor Authentication
                  </p>
                  <p class="text-sm text-gray-600">
                    Add an extra layer of security
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" id="2fa-toggle" class="sr-only peer" />
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"
                  ></div>
                </label>
              </div>
              <button
                class="w-full bg-red-100 hover:bg-red-200 text-red-700 px-6 py-4 rounded-2xl font-semibold transition-all duration-300"
              >
                <i class="fas fa-key mr-2"></i>Change Password
              </button>
            </div>
          </div>
        </div>
      </template>

      <template id="user-settings-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Settings
          </h1>
          <p class="text-gray-600 text-lg">Customize your banking experience</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Preferences</h3>
            <div class="space-y-6">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-semibold text-gray-800">Dark Mode</p>
                  <p class="text-sm text-gray-600">Switch to dark theme</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    id="dark-mode-toggle"
                    class="sr-only peer"
                  />
                  <div
                    class="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"
                  ></div>
                </label>
              </div>
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-semibold text-gray-800">Email Notifications</p>
                  <p class="text-sm text-gray-600">
                    Receive transaction alerts
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    id="email-notifications"
                    class="sr-only peer"
                    checked
                  />
                  <div
                    class="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"
                  ></div>
                </label>
              </div>
            </div>
          </div>

          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Export Data</h3>
            <div class="space-y-4">
              <button class="w-full neo-btn">
                <i class="fas fa-download mr-2"></i>Download Statements
              </button>
              <button
                class="w-full bg-green-100 hover:bg-green-200 text-green-700 px-6 py-4 rounded-2xl font-semibold transition-all duration-300"
              >
                <i class="fas fa-file-csv mr-2"></i>Export CSV
              </button>
            </div>
          </div>
        </div>
      </template>

      <!-- Admin Templates -->
      <template id="admin-dashboard-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Admin Dashboard
          </h1>
          <p class="text-gray-600 text-lg">System overview and management</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-8">
          <div
            class="card-modern bg-gradient-to-br from-blue-500 to-blue-600 text-white"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="text-blue-100 text-sm">Total Users</p>
                <p id="total-users" class="text-3xl font-black">0</p>
              </div>
              <i class="fas fa-users text-3xl text-blue-200"></i>
            </div>
          </div>
          <div
            class="card-modern bg-gradient-to-br from-green-500 to-green-600 text-white"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="text-green-100 text-sm">Total Accounts</p>
                <p id="total-accounts" class="text-3xl font-black">0</p>
              </div>
              <i class="fas fa-university text-3xl text-green-200"></i>
            </div>
          </div>
          <div
            class="card-modern bg-gradient-to-br from-purple-500 to-purple-600 text-white"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="text-purple-100 text-sm">Transactions Today</p>
                <p id="transactions-today" class="text-3xl font-black">0</p>
              </div>
              <i class="fas fa-exchange-alt text-3xl text-purple-200"></i>
            </div>
          </div>
          <div
            class="card-modern bg-gradient-to-br from-red-500 to-red-600 text-white"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="text-red-100 text-sm">Security Alerts</p>
                <p id="security-alerts" class="text-3xl font-black">0</p>
              </div>
              <i class="fas fa-shield-alt text-3xl text-red-200"></i>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
              Recent Activity
            </h3>
            <div id="admin-recent-activity" class="space-y-4">
              <!-- Will be populated -->
            </div>
          </div>
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">System Status</h3>
            <div class="space-y-4">
              <div class="flex items-center justify-between">
                <span class="text-gray-600">API Status</span>
                <span class="flex items-center text-green-600 font-semibold">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  Online
                </span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-gray-600">Database</span>
                <span class="flex items-center text-green-600 font-semibold">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  Connected
                </span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-gray-600">AI Services</span>
                <span class="flex items-center text-green-600 font-semibold">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  Active
                </span>
              </div>
            </div>
          </div>
        </div>
      </template>

      <template id="admin-users-template">
        <div class="flex justify-between items-center mb-8">
          <div>
            <h1 class="text-4xl font-black text-gray-800 mb-2 animate-slide-up">
              User Management
            </h1>
            <p class="text-gray-600 text-lg">Manage all system users</p>
          </div>
          <button
            onclick="showModal('admin-create-user-modal')"
            class="neo-btn"
          >
            <i class="fas fa-plus mr-2"></i>Create User
          </button>
        </div>

        <div class="card-modern">
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    User
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Status
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Created By
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Member Since
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody id="users-table-body" class="divide-y divide-gray-200">
                <!-- Users will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </template>

      <template id="admin-transactions-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            All Transactions
          </h1>
          <p class="text-gray-600 text-lg">
            Monitor and manage all system transactions
          </p>
        </div>

        <div class="card-modern">
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Transaction Details
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Amount
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Date
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-900"
                  >
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody
                id="admin-transactions-body"
                class="divide-y divide-gray-200"
              >
                <!-- Transactions will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </template>

      <template id="admin-reports-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Reports & Analytics
          </h1>
          <p class="text-gray-600 text-lg">
            Generate comprehensive system reports
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
              Export Reports
            </h3>
            <div class="space-y-4">
              <button id="download-report-btn" class="neo-btn w-full">
                <i class="fas fa-download mr-2"></i>Transaction Report (CSV)
              </button>
              <button
                class="w-full bg-green-100 hover:bg-green-200 text-green-700 px-6 py-4 rounded-2xl font-semibold transition-all duration-300"
              >
                <i class="fas fa-file-pdf mr-2"></i>User Report (PDF)
              </button>
              <button
                class="w-full bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-4 rounded-2xl font-semibold transition-all duration-300"
              >
                <i class="fas fa-chart-bar mr-2"></i>Analytics Report
              </button>
            </div>
          </div>

          <div class="card-modern">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Quick Stats</h3>
            <div class="space-y-4">
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Total Volume</span>
                <span class="font-bold text-2xl text-green-600">$125,430</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Active Users</span>
                <span class="font-bold text-2xl text-blue-600">342</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Success Rate</span>
                <span class="font-bold text-2xl text-green-600">99.8%</span>
              </div>
            </div>
          </div>
        </div>
      </template>

      <template id="admin-security-template">
        <div class="mb-8">
          <h1 class="text-4xl font-black text-gray-800 mb-4 animate-slide-up">
            Security Center
          </h1>
          <p class="text-gray-600 text-lg">
            Monitor system security and threats
          </p>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
          <div class="xl:col-span-2">
            <div class="card-modern mb-8">
              <h3 class="text-2xl font-bold text-gray-800 mb-6">
                Security Alerts
              </h3>
              <div class="space-y-4">
                <div
                  class="flex items-center p-4 bg-red-50 border border-red-200 rounded-xl"
                >
                  <div
                    class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-4"
                  >
                    <i class="fas fa-exclamation-triangle text-red-600"></i>
                  </div>
                  <div class="flex-1">
                    <p class="font-semibold text-red-800">
                      Failed Login Attempts
                    </p>
                    <p class="text-sm text-red-600">
                      Multiple failed attempts from IP 192.168.1.100
                    </p>
                  </div>
                  <span class="text-xs text-red-500">2 min ago</span>
                </div>
                <div
                  class="flex items-center p-4 bg-yellow-50 border border-yellow-200 rounded-xl"
                >
                  <div
                    class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center mr-4"
                  >
                    <i class="fas fa-shield-alt text-yellow-600"></i>
                  </div>
                  <div class="flex-1">
                    <p class="font-semibold text-yellow-800">
                      Security Update Available
                    </p>
                    <p class="text-sm text-yellow-600">
                      System security patch ready for deployment
                    </p>
                  </div>
                  <span class="text-xs text-yellow-500">1 hr ago</span>
                </div>
              </div>
            </div>

            <div class="card-modern">
              <h3 class="text-2xl font-bold text-gray-800 mb-6">Access Logs</h3>
              <div class="overflow-x-auto">
                <table class="min-w-full">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-4 py-3 text-left text-sm font-semibold text-gray-900"
                      >
                        User
                      </th>
                      <th
                        class="px-4 py-3 text-left text-sm font-semibold text-gray-900"
                      >
                        Action
                      </th>
                      <th
                        class="px-4 py-3 text-left text-sm font-semibold text-gray-900"
                      >
                        IP Address
                      </th>
                      <th
                        class="px-4 py-3 text-left text-sm font-semibold text-gray-900"
                      >
                        Time
                      </th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-200">
                    <tr>
                      <td class="px-4 py-3 text-sm">admin</td>
                      <td class="px-4 py-3 text-sm">Login</td>
                      <td class="px-4 py-3 text-sm">127.0.0.1</td>
                      <td class="px-4 py-3 text-sm">2 min ago</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div>
            <div class="card-modern mb-8">
              <h3 class="text-xl font-bold text-gray-800 mb-6">
                Security Status
              </h3>
              <div class="space-y-4">
                <div class="flex justify-between items-center">
                  <span class="text-gray-600">Firewall</span>
                  <span class="flex items-center text-green-600 font-semibold">
                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                    Active
                  </span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-600">Encryption</span>
                  <span class="flex items-center text-green-600 font-semibold">
                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                    256-bit SSL
                  </span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-600">2FA</span>
                  <span class="flex items-center text-green-600 font-semibold">
                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                    Enabled
                  </span>
                </div>
              </div>
            </div>

            <div class="card-modern">
              <h3 class="text-xl font-bold text-gray-800 mb-6">
                Quick Actions
              </h3>
              <div class="space-y-3">
                <button
                  class="w-full bg-red-100 hover:bg-red-200 text-red-700 px-4 py-3 rounded-xl font-semibold transition-all duration-300"
                >
                  <i class="fas fa-ban mr-2"></i>Block IP
                </button>
                <button
                  class="w-full bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-4 py-3 rounded-xl font-semibold transition-all duration-300"
                >
                  <i class="fas fa-sync mr-2"></i>Force Logout All
                </button>
                <button
                  class="w-full bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-3 rounded-xl font-semibold transition-all duration-300"
                >
                  <i class="fas fa-download mr-2"></i>Export Logs
                </button>
              </div>
            </div>
          </div>
        </div>
      </template>

      <!-- Additional Modals -->
      <div
        id="admin-create-user-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4"
            >
              <i class="fas fa-user-plus text-white text-2xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800">Create New User</h2>
            <p class="text-gray-600 mt-2">Add a new user to the system</p>
          </div>
          <form id="admin-create-user-form" class="space-y-6">
            <div class="relative">
              <i
                class="fas fa-user absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="create-username"
                class="form-modern pl-12"
                placeholder="Username"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-envelope absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="email"
                id="create-email"
                class="form-modern pl-12"
                placeholder="Email Address"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="password"
                id="create-password"
                class="form-modern pl-12"
                placeholder="Initial Password"
                required
              />
            </div>
            <button type="submit" class="neo-btn w-full text-lg">
              <i class="fas fa-plus mr-2"></i>Create User
            </button>
          </form>
          <p
            id="admin-create-user-message"
            class="mt-6 text-center text-sm"
          ></p>
          <div class="mt-8 text-center">
            <button
              onclick="closeModals()"
              class="text-gray-500 hover:text-gray-700 font-medium"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <div
        id="edit-transaction-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50"
      >
        <div class="glass-card max-w-md w-full mx-4 animate-fade-scale">
          <div class="text-center mb-8">
            <div
              class="w-16 h-16 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4"
            >
              <i class="fas fa-edit text-white text-2xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800">Edit Transaction</h2>
          </div>
          <form id="edit-transaction-form" class="space-y-6">
            <input type="hidden" id="edit-tx-id" />
            <div class="relative">
              <i
                class="fas fa-comment absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="edit-tx-description"
                class="form-modern pl-12"
                placeholder="Description"
                required
              />
            </div>
            <div class="relative">
              <i
                class="fas fa-tag absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"
              ></i>
              <input
                type="text"
                id="edit-tx-type"
                class="form-modern pl-12"
                placeholder="Type"
                required
              />
            </div>
            <button type="submit" class="neo-btn w-full text-lg">
              <i class="fas fa-save mr-2"></i>Save Changes
            </button>
          </form>
          <div class="mt-8 text-center">
            <button
              onclick="closeModals()"
              class="text-gray-500 hover:text-gray-700 font-medium"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Enhanced State Management
      const state = {
        token: localStorage.getItem("token"),
        username: localStorage.getItem("username"),
        isAdmin: localStorage.getItem("isAdmin") === "true",
        pendingUserId: null, // For 2FA flow
        account: null,
        spendingChart: null,
        darkMode: localStorage.getItem("darkMode") === "true",
      };

      // DOM Elements
      const views = {
        homepage: document.getElementById("homepage-view"),
        userDashboard: document.getElementById("user-dashboard"),
        adminDashboard: document.getElementById("admin-dashboard"),
      };

      const modals = document.querySelectorAll(".fixed.inset-0");
      const loadingOverlay = document.getElementById("loading-overlay");

      // Enhanced API Request with better error handling
      async function apiRequest(endpoint, method = "GET", body = null) {
        showLoading(true);
        const headers = { "Content-Type": "application/json" };
        if (state.token) headers["x-access-token"] = state.token;

        try {
          const response = await fetch(`/api${endpoint}`, {
            method,
            headers,
            body: body ? JSON.stringify(body) : null,
          });

          const data = await response.json();

          if (response.status === 401) {
            logout();
            showNotification(
              data.message || "Session expired. Please login again.",
              "error"
            );
            return { ok: false, data };
          }

          return { ok: response.ok, data };
        } catch (error) {
          console.error("API Request Error:", error);
          showNotification(
            "Network error. Please check your connection.",
            "error"
          );
          return { ok: false, data: { message: "Network error" } };
        } finally {
          showLoading(false);
        }
      }

      // Enhanced Notification System
      function showNotification(message, type = "info", duration = 5000) {
        const container = document.getElementById("notification-container");
        const notification = document.createElement("div");
        notification.className = `notification ${type} animate-slide-right`;
        notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${
                      type === "success"
                        ? "check-circle"
                        : type === "error"
                        ? "exclamation-circle"
                        : "info-circle"
                    } mr-3"></i>
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white/80 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

        container.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, duration);
      }

      // Enhanced Loading Management
      function showLoading(show = true) {
        if (show) {
          loadingOverlay.classList.remove("hidden");
        } else {
          loadingOverlay.classList.add("hidden");
        }
      }

      // View Management
      function showView(viewId) {
        Object.values(views).forEach((v) => v.classList.add("hidden"));
        if (views[viewId]) {
          views[viewId].classList.remove("hidden");
        }
      }

      // Enhanced Logout
      function logout() {
        localStorage.clear();
        Object.assign(state, {
          token: null,
          username: null,
          isAdmin: false,
          pendingUserId: null,
        });
        showView("homepage");
        document.getElementById("chatbot-container").classList.add("hidden");
        showNotification("Logged out successfully", "info");
      }

      // Modal Management
      function showModal(modalId) {
        document.getElementById(modalId)?.classList.remove("hidden");
      }

      function closeModals() {
        modals.forEach((m) => m.classList.add("hidden"));
      }

      // Enhanced Navigation Setup
      function setupNavigation(containerId, mainContentId, isAdminNav) {
        const container = document.getElementById(containerId);
        if (!container) return;

        container.addEventListener("click", (e) => {
          const item = e.target.closest(
            isAdminNav ? ".admin-sidebar-modern" : ".sidebar-modern"
          );
          if (item) {
            e.preventDefault();
            container
              .querySelectorAll("a")
              .forEach((i) => i.classList.remove("active"));
            item.classList.add("active");
            loadViewContent(item.dataset.view, mainContentId);
          }
        });
      }

      // Enhanced Content Loading
      function loadViewContent(viewId, mainContentId) {
        const template = document.getElementById(
          `${viewId.replace("-content", "")}-template`
        );
        const container = document.getElementById(mainContentId);

        if (template && container) {
          container.style.opacity = "0";
          container.style.transform = "translateY(20px)";

          setTimeout(() => {
            container.innerHTML = template.innerHTML;
            container.style.opacity = "1";
            container.style.transform = "translateY(0)";
            container.style.transition = "all 0.3s ease-out";

            const viewActions = {
              "user-dashboard-content": initUserDashboardContent,
              "user-transactions-content": initTransactionsContent,
              "user-billpay-content": initBillPayContent,
              "user-profile-content": initProfileContent,
              "user-settings-content": initSettingsContent,
              "admin-dashboard-content": initAdminDashboardContent,
              "admin-users-content": initAdminUsersContent,
              "admin-transactions-content": initAdminTransactionsContent,
              "admin-reports-content": initAdminReportsContent,
              "admin-security-content": initAdminSecurityContent,
            };

            if (viewActions[viewId]) {
              viewActions[viewId]();
            }
          }, 150);
        }
      }

      // --- LOGIN AND AUTHENTICATION ---

      async function handleUserLogin(form) {
        const res = await apiRequest("/login", "POST", {
          username: form.elements["user-username"].value,
          password: form.elements["user-password"].value,
        });

        const messageEl = document.getElementById("user-login-message");
        if (res.ok) {
          state.pendingUserId = res.data.user_id;
          showModal("tfa-modal");
        } else {
          messageEl.textContent = res.data.message;
          messageEl.className = "mt-6 text-center text-sm text-red-600";
        }
      }

      async function handleAdminLogin(form) {
        const res = await apiRequest("/admin/login", "POST", {
          username: form.elements["admin-username"].value,
          password: form.elements["admin-password"].value,
        });

        if (res.ok) {
          state.token = res.data.token;
          state.username = res.data.username;
          state.isAdmin = true;
          localStorage.setItem("token", state.token);
          localStorage.setItem("username", state.username);
          localStorage.setItem("isAdmin", "true");
          closeModals();
          showNotification(`Welcome, ${state.username}!`, "success");
          initAdminDashboard();
        } else {
          const messageEl = document.getElementById("admin-login-message");
          messageEl.textContent = res.data.message;
          messageEl.className = "mt-6 text-center text-sm text-red-600";
        }
      }

      async function verify2FA() {
        const code = document.getElementById("tfa-code").value;
        if (!code || !state.pendingUserId) {
          showNotification(
            "Invalid request. Please try logging in again.",
            "error"
          );
          return;
        }

        const res = await apiRequest("/login/verify", "POST", {
          user_id: state.pendingUserId,
          code: code,
        });

        if (res.ok) {
          state.token = res.data.token;
          state.username = res.data.username;
          state.isAdmin = false;
          state.pendingUserId = null; // Clear pending state
          localStorage.setItem("token", state.token);
          localStorage.setItem("username", state.username);
          localStorage.setItem("isAdmin", "false");
          closeModals();
          showNotification(`Welcome back, ${state.username}!`, "success");
          initUserDashboard();
        } else {
          showNotification(res.data.message || "Verification failed.", "error");
        }
      }

      async function handleRegistration(e) {
        e.preventDefault();
        const formData = {
          username: e.target.elements["register-username"].value,
          email: e.target.elements["register-email"].value,
          password: e.target.elements["register-password"].value,
        };

        const res = await apiRequest("/register", "POST", formData);
        const messageEl = document.getElementById("register-message");

        if (messageEl) {
          messageEl.textContent = res.data.message;
          messageEl.className = `mt-6 text-center text-sm ${
            res.ok ? "text-green-600" : "text-red-600"
          }`;
        }

        if (res.ok) {
          showNotification(
            "Account created successfully! Please login.",
            "success"
          );
          setTimeout(() => {
            closeModals();
            showModal("user-login-modal");
          }, 2000);
        } else {
          showNotification(res.data.message, "error");
        }
      }

      // --- DASHBOARD AND CONTENT INITIALIZATION ---

      function initUserDashboard() {
        showView("userDashboard");
        document.getElementById("chatbot-container").classList.remove("hidden");
        document.getElementById("sidebar-username").textContent =
          state.username;
        loadViewContent("user-dashboard-content", "user-main-content");
      }

      function initAdminDashboard() {
        showView("adminDashboard");
        loadViewContent("admin-dashboard-content", "admin-main-content");
      }

      async function initUserDashboardContent() {
        document.getElementById("dashboard-username").textContent =
          state.username;
        await fetchDashboardData();
        setupTransactionForm();
      }

      async function fetchDashboardData() {
        const accountRes = await apiRequest("/account");
        if (accountRes.ok && accountRes.data.account) {
          state.account = accountRes.data.account;
          document.getElementById("account-number").textContent =
            state.account.account_number;
          document.getElementById(
            "account-balance"
          ).textContent = `$${parseFloat(state.account.balance).toFixed(2)}`;
        }

        const insightsRes = await apiRequest("/insights");
        if (insightsRes.ok) {
          renderSpendingChart(insightsRes.data);
        }

        const transactionsRes = await apiRequest("/transactions");
        if (transactionsRes.ok) {
          renderRecentTransactions(
            transactionsRes.data.transactions.slice(0, 5)
          );
          updateTransactionStats(transactionsRes.data.transactions);
        }
      }

      function renderRecentTransactions(transactions) {
        const container = document.getElementById("recent-transactions");
        if (!container) return;

        if (transactions.length === 0) {
          container.innerHTML =
            '<p class="text-gray-500 text-center py-8">No recent transactions</p>';
          return;
        }

        container.innerHTML = transactions
          .map((tx) => {
            const isDebit = tx.from_account === state.account?.account_number;
            return `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors">
                        <div class="flex items-center">
                            <div class="w-10 h-10 ${
                              isDebit ? "bg-red-100" : "bg-green-100"
                            } rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-${
                                  isDebit ? "arrow-up" : "arrow-down"
                                } ${
              isDebit ? "text-red-600" : "text-green-600"
            }"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-gray-800">${
                                  tx.description
                                }</p>
                                <p class="text-sm text-gray-500">${
                                  isDebit
                                    ? "To: " + tx.to_account
                                    : "From: " + tx.from_account
                                }</p>
                            </div>
                        </div>
                        <span class="font-bold ${
                          isDebit ? "text-red-600" : "text-green-600"
                        }">
                            ${isDebit ? "-" : "+"}$${tx.amount.toFixed(2)}
                        </span>
                    </div>
                `;
          })
          .join("");
      }

      function updateTransactionStats(transactions) {
        const countEl = document.getElementById("transaction-count");
        const avgEl = document.getElementById("avg-transaction");

        if (countEl) countEl.textContent = transactions.length;
        if (avgEl && transactions.length > 0) {
          const avg =
            transactions.reduce((sum, tx) => sum + tx.amount, 0) /
            transactions.length;
          avgEl.textContent = `$${avg.toFixed(2)}`;
        }
      }

      function setupTransactionForm() {
        const form = document.getElementById("transaction-form");
        if (form) {
          form.addEventListener("submit", handleTransfer);
        }
      }

      async function handleTransfer(e) {
        e.preventDefault();
        const formData = {
          to_account_number: e.target.elements["to-account"].value,
          amount: e.target.elements["amount"].value,
          description: e.target.elements["description"]?.value || "Transfer",
        };

        const res = await apiRequest("/transactions", "POST", formData);
        const messageEl = document.getElementById("transaction-message");

        if (messageEl) {
          messageEl.textContent = res.data.message;
          messageEl.className = `text-sm mt-4 ${
            res.ok ? "text-green-600" : "text-red-600"
          }`;
        }

        if (res.ok) {
          e.target.reset();
          showNotification("Transfer completed successfully!", "success");
          await fetchDashboardData(); // Refresh data
        } else {
          showNotification(res.data.message, "error");
        }
      }

      function renderSpendingChart({ labels, data }) {
        const canvas = document.getElementById("spending-chart");
        const fallback = document.getElementById("spending-chart-fallback");

        if (!canvas || !fallback) return;

        if (state.spendingChart) {
          state.spendingChart.destroy();
        }

        if (!labels || labels.length === 0) {
          fallback.classList.remove("hidden");
          canvas.classList.add("hidden");
          return;
        }

        fallback.classList.add("hidden");
        canvas.classList.remove("hidden");

        state.spendingChart = new Chart(canvas.getContext("2d"), {
          type: "doughnut",
          data: {
            labels,
            datasets: [
              {
                data,
                backgroundColor: [
                  "#4f46e5",
                  "#10b981",
                  "#ef4444",
                  "#f59e0b",
                  "#8b5cf6",
                  "#3b82f6",
                  "#ec4899",
                ],
                borderColor: "#ffffff",
                borderWidth: 4,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  usePointStyle: true,
                  pointStyle: "rectRounded",
                },
              },
            },
            cutout: "70%",
          },
        });
      }

      // (Other content init functions like initTransactionsContent, initBillPayContent, etc. would go here)
      // These are omitted for brevity but would follow the same pattern of fetching data and rendering it.

      // --- CHATBOT ---

      const chatbotToggle = document.getElementById("chatbot-toggle");
      const chatbotWindow = document.getElementById("chatbot-window");
      chatbotToggle.addEventListener("click", () =>
        chatbotWindow.classList.toggle("hidden")
      );
      document
        .getElementById("chatbot-close")
        .addEventListener("click", () => chatbotWindow.classList.add("hidden"));
      const chatInput = document.getElementById("chat-input");
      const sendMessageBtn = document.getElementById("send-message");
      const chatMessages = document.getElementById("chat-messages");
      const sendMessage = async () => {
        const message = chatInput.value.trim();
        if (!message) return;
        addChatMessage(message, "user");
        chatInput.value = "";
        const res = await apiRequest("/chatbot", "POST", { message });
        if (res.ok) {
          addChatMessage(res.data.reply, "bot");
        } else {
          addChatMessage(
            "Sorry, I'm having trouble connecting right now.",
            "bot"
          );
        }
      };
      sendMessageBtn.addEventListener("click", sendMessage);
      chatInput.addEventListener(
        "keypress",
        (e) => e.key === "Enter" && sendMessage()
      );

      function addChatMessage(text, sender) {
        const div = document.createElement("div");
        const isUser = sender === "user";

        div.className = `flex mb-4 ${isUser ? "justify-end" : "justify-start"}`;

        const bubbleContent = `
                <div class="max-w-xs">
                    <div class="px-4 py-3 rounded-2xl ${
                      isUser
                        ? "bg-indigo-500 text-white rounded-br-none"
                        : "bg-gray-200 text-gray-800 rounded-bl-none"
                    }">
                        ${text.replace(/\n/g, "<br>")}
                    </div>
                </div>
            `;

        div.innerHTML = bubbleContent;
        chatMessages.appendChild(div);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      // --- INITIALIZATION ---
      document.addEventListener("DOMContentLoaded", () => {
        if (state.token) {
          if (state.isAdmin) {
            initAdminDashboard();
          } else {
            initUserDashboard();
          }
        } else {
          showView("homepage");
        }

        // Setup form listeners
        document
          .getElementById("user-login-form")
          .addEventListener("submit", (e) => {
            e.preventDefault();
            handleUserLogin(e.currentTarget);
          });
        document
          .getElementById("admin-login-form")
          .addEventListener("submit", (e) => {
            e.preventDefault();
            handleAdminLogin(e.currentTarget);
          });
        document
          .getElementById("register-form")
          .addEventListener("submit", handleRegistration);

        setupNavigation("user-sidebar-nav", "user-main-content", false);
        setupNavigation("admin-sidebar-nav", "admin-main-content", true);

        if (state.darkMode) {
          document.documentElement.classList.add("dark");
        }
      });

      // Stubs for other functions to avoid errors - these would be fully implemented
      function initTransactionsContent() {
        /* Fetch and render all transactions */
      }
      function initBillPayContent() {
        /* Fetch billers and set up form */
      }
      function initProfileContent() {
        /* Fetch user profile */
      }
      function initSettingsContent() {
        /* Set up settings toggles */
      }
      function initAdminDashboardContent() {
        /* Fetch admin stats */
      }
      function initAdminUsersContent() {
        /* Fetch all users */
      }
      function initAdminTransactionsContent() {
        /* Fetch all transactions */
      }
      function initAdminReportsContent() {
        /* Set up report downloads */
      }
      function initAdminSecurityContent() {
        /* Fetch security logs */
      }
    </script>
  </body>
</html>
